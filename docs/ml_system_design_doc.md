# ML System Design Doc
## Дизайн ML системы - Universal Document OCR PoC итерация 1

### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

- Бизнес-цель: ускорение(конкурентное преимущество) и удешевление(уменьшение стоимости операционных процессов) процесса обработки сканов документов для заказчика.

- Почему станет лучше, чем сейчас, при использовании VLM по сравнению с более традиционными OCR DL подходами?

Использование систем OCR DL предполагает довольно тонкую настройку всего OCR пайплайна на шаблон имеющегося документа.
В организации очень много различных документов самых разных шаблонов от самых разных клиентов, заказчиков и т.д. Это вынуждает команду работающую с OCR DL разрабатывать все новые и новые узкоспециализированные пайпайлны обработки документов. 
Использование Visual LM/LLM для извлечения важных данных из сканов документов обеспечивает большую универсальность в их обработке.

- Что будем считать успехом итерации с точки зрения бизнеса?

**На 1-вой итерации нашего PoC:**
* Будет осуществлен бенчмарк для VLLM моделей, по обработке синтетических паспортов несуществующих граждан РФ( сейчас идет PoC исследование на синтетических данных, которые не являются настоящими документами).
* Сформирован отчет о протестированных моделях, достигнутых метриках, производительности моделей и потребляемых ресурсах.
#### 1.2. Бизнес-требования и ограничения  

- Краткое описание БТ
1. Модель должна уметь считывать с изображений информацию на русском и английском языках.
2. Модель должна обеспечивать сопоставимый уровень по корректности извлеченных данных с уже имеющимся у компании решением.

- Бизнес-ограничения
1. Обработка одного документа не более 1 секунды
2. Модель VLLM должна умещаться на одну GPU

- Что мы ожидаем от конкретной итерации

На данной 1-вой итерации нашего PoC важно оценить корректность извлечения данных с использованием VLLM на синтетических данных с соблюдением бизнес ограничений.
Данная стадия посвящена оценке самой возможности использования VLLM в задаче извлечения данных с паспортов.
Интеграции MVP-сервиса в контур компании не предполагается. 

- Что считаем успешным пилотом? Критерии успеха и возможные пути развития проекта

* Модель должна выполнять бизнес требования заказчика.
* По возможности приближаться по своим параметрам к бизнес-ограничениям.

#### 1.3. Что входит в скоуп проекта/итерации, что не входит   

- На данной итерации PoC мы должны полностью выполнить бизнес требования заказчика:
1. Модель должна уметь считывать с изображений информацию на русском и английском языках

- Что не будет закрыто
1. Поскольку проект на стадии PoC, не гарантируется, что среди протестированных моделей будет найдена та, что сможет обеспечивать сопоставимый уровень по корректности извлеченных данных с уже имеющимся у компании решением.
2. Поскольку проект на стадии PoC, не обязательно выполнять Бизнес-ограничения полностью, но желательно к ним приближаться.

- Описание результата с точки зрения качества кода и воспроизводимости решения

**Воспроизводимость:**
1. `Git`-репозиторий с кодом бенчмарка модели
2. `Docker`-образ для полного воспроизведения рабочего окружения
3. Воспроизводимость пайплана тестирования моделей на датасете с помощью `DVC`

**Качество кода:**
1. Использовать авто форматирование кода на основе `Black` и `isort`
2. Использовать pre-commit hooks с `ruff` и `black` для обеспечения качества кода
3. Использовать `Google Style with type annotations` ([ссылка](../cards/Стили%20документации%20docstring%20в%20Python.md)) для python docstring

- Описание планируемого технического долга
1. Разработка сервиса с моделью VLLM к которому можно будет отправлять запросы по Fast API не входит в данную стадию работы над проектом.

#### 1.4. Предпосылки решения

1. Получить от компании датасет с синтетическими паспортами несуществующих граждан РФ (ожидаю)
2. Тестировать доступные открытые модели VLM на синтетических данных компании/открытых данных найденных в сети интернет (сейчас так).
3. Разработать бенчмарк оценки моделей на синтетическом датасете
4. Сделать выводы о соответствии бизнес требованиям и бизнес ограничениям

### 2. Методология 

#### 2.1. Постановка задачи  

С технической точки зрения, мы решаем задачу **Document Visual Question Answering** ([ссылка](../cards/Задачи%20решаемые%20моделями%20VLLM%20для%20документов.md)).

#### 2.2. Блок-схема PoC решения

![](../files/ml_system_design_doc%202024-11-29%2003.24.09.excalidraw.png)
